<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The Sparta Modeling Framework: Core Example Using Sparta</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">The Sparta Modeling Framework
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('core_example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Core Example Using Sparta </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Sparta core example is located in sparta/example/CoreModel.</p>
<hr  />
 <h1><a class="anchor" id="example_core"></a>
Example Core Layout</h1>
<p>The CoreExample is an example Sparta simulator that uses the Sparta framework to mimic a very rudimentary model of a simple out-of-order core. The model does not have dependency checking nor actually renames any instructions. The "ISA" is uses is a few random instructions pulled from the PowerPC ISA listed in a table in <a class="el" href="Fetch_8cpp.html" title="Implementation of the CoreModel Fetch unit.">Fetch.cpp</a>.</p>
<p>The example touches on Sparta command line simulation, construction phasing, unit creation, port creation and binding, event creation, and data transfer.</p>
<p>The ExampleCore has a simple pipeline:</p>
<div class="dotgraph">
<img src="dot_inline_dotgraph_2.png" alt="dot_inline_dotgraph_2.png" border="0" usemap="#dot_inline_dotgraph_2.map"/>
<map name="dot_inline_dotgraph_2.map" id="dot_inline_dotgraph_2.map"><area shape="rect" href="Fetch_8hpp.html" title="\N" alt="" coords="5,265,77,314"/>
<area shape="rect" href="Decode_8hpp_source.html" title="\N" alt="" coords="199,265,271,314"/>
<area shape="poly" href="CoreTypes_8hpp_source.html" title="InstGroup" alt="" coords="78,287,185,287,185,292,78,292"/>
<area shape="rect" href="CoreTypes_8hpp_source.html" title="InstGroup" alt="" coords="101,269,175,289"/>
<area shape="rect" href="Rename_8hpp_source.html" title="\N" alt="" coords="392,265,464,314"/>
<area shape="poly" href="CoreTypes_8hpp_source.html" title="InstGroup" alt="" coords="271,287,378,287,378,292,271,292"/>
<area shape="rect" href="CoreTypes_8hpp_source.html" title="InstGroup" alt="" coords="295,269,368,289"/>
<area shape="rect" href="Dispatch_8hpp_source.html" title="\N" alt="" coords="585,265,659,314"/>
<area shape="poly" href="CoreTypes_8hpp_source.html" title="InstGroup" alt="" coords="464,287,571,287,571,292,464,292"/>
<area shape="rect" href="CoreTypes_8hpp_source.html" title="InstGroup" alt="" coords="488,269,561,289"/>
<area shape="rect" href="Execute_8hpp_source.html" title="\N" alt="" coords="780,19,852,69"/>
<area shape="poly" href="ExampleInst_8hpp_source.html" title="Inst" alt="" coords="623,265,629,210,640,141,657,78,668,54,681,38,701,27,723,23,767,26,766,31,723,28,703,32,684,42,673,57,662,80,645,142,634,210,628,266"/>
<area shape="rect" href="ExampleInst_8hpp_source.html" title="Inst" alt="" coords="705,5,733,25"/>
<area shape="rect" href="Execute_8hpp_source.html" title="\N" alt="" coords="780,106,852,155"/>
<area shape="poly" href="ExampleInst_8hpp_source.html" title="Inst" alt="" coords="623,265,628,235,638,201,655,167,681,139,701,128,723,122,766,120,766,126,724,128,703,133,684,143,660,170,643,203,633,236,628,266"/>
<area shape="rect" href="ExampleInst_8hpp_source.html" title="Inst" alt="" coords="705,103,733,123"/>
<area shape="rect" href="Execute_8hpp_source.html" title="\N" alt="" coords="780,214,852,263"/>
<area shape="poly" href="ExampleInst_8hpp_source.html" title="Inst" alt="" coords="646,263,662,250,682,240,725,231,766,230,766,236,725,236,684,245,665,255,649,267"/>
<area shape="rect" href="ExampleInst_8hpp_source.html" title="Inst" alt="" coords="705,213,733,233"/>
<area shape="rect" href="Execute_8hpp_source.html" title="\N" alt="" coords="780,315,852,365"/>
<area shape="poly" href="ExampleInst_8hpp_source.html" title="Inst" alt="" coords="660,302,683,311,767,330,766,335,682,316,658,307"/>
<area shape="rect" href="ExampleInst_8hpp_source.html" title="Inst" alt="" coords="705,293,733,313"/>
<area shape="rect" href="LSU_8hpp_source.html" title="\N" alt="" coords="780,417,852,466"/>
<area shape="poly" href="ExampleInst_8hpp_source.html" title="Inst" alt="" coords="635,312,655,349,684,385,725,410,767,427,765,432,722,415,681,389,650,352,631,315"/>
<area shape="rect" href="ExampleInst_8hpp_source.html" title="Inst" alt="" coords="705,367,733,387"/>
<area shape="rect" href="ROB_8hpp_source.html" title="\N" alt="" coords="780,518,852,567"/>
<area shape="poly" href="CoreTypes_8hpp_source.html" title="InstGroup" alt="" coords="627,313,631,351,640,396,657,443,685,485,703,501,723,514,767,530,765,535,721,518,699,505,681,488,653,446,635,398,626,351,622,314"/>
<area shape="rect" href="CoreTypes_8hpp_source.html" title="InstGroup" alt="" coords="683,467,756,487"/>
<area shape="rect" href="BIU_8hpp_source.html" title="\N" alt="" coords="928,417,1000,466"/>
<area shape="poly" href="ExampleInst_8hpp_source.html" title="Inst" alt="" coords="852,439,914,439,914,444,852,444"/>
<area shape="rect" href="ExampleInst_8hpp_source.html" title="Inst" alt="" coords="876,421,904,441"/>
<area shape="rect" href="MSS_8hpp_source.html" title="\N" alt="" coords="1076,417,1148,466"/>
<area shape="poly" href="ExampleInst_8hpp_source.html" title="Inst" alt="" coords="1000,439,1062,439,1062,444,1000,444"/>
<area shape="rect" href="ExampleInst_8hpp_source.html" title="Inst" alt="" coords="1024,421,1052,441"/>
</map>
</div>
<p>This heirarchy is built in core_example::ExampleSimulator::buildTree_ pulling resources and factories from <a class="el" href="classcore__example_1_1CoreTopology__1.html" title="CoreTopology_1 topology class.">core_example::CoreTopology_1</a>.</p>
<p>Instructions are created in <code>Fetch</code> and progression of these instructions is based on a credit system. Credits flow from <code>ROB</code> through <code>Dispatch</code> though <code>Rename</code>, etc. in 0 time (dotted lines) while instructions flow from <code>Fetch</code> to <code>Decode</code> to <code>Rename</code>, etc (solid lines) in a delay of 1 cycle. This flow is controlled based on the rule (adopted by this example) that all <code>DataInPorts&lt;core_example::InstGroup&gt;</code> take objects delayed by 1 cycle (set at instantiation time) and all credit <code>DataInPorts&lt;uint32_t&gt;</code> are assumed to be 0 cycle. For example:</p>
<div class="dotgraph">
<img src="dot_inline_dotgraph_3.png" alt="dot_inline_dotgraph_3.png" border="0" usemap="#dot_inline_dotgraph_3.map"/>
</div>
<p>These ports are bound in core_example::ExampleSimulator::bindTree_, using the <code>port_connections</code> list defined in <a class="el" href="classcore__example_1_1CoreTopology__1.html" title="CoreTopology_1 topology class.">core_example::CoreTopology_1</a>. The ports themselves are instantiated in <a class="el" href="Fetch_8cpp.html" title="Implementation of the CoreModel Fetch unit.">Fetch.cpp</a> / <a class="el" href="Fetch_8hpp.html" title="Definition of the CoreModel Fetch unit.">Fetch.hpp</a> and <a class="el" href="Decode_8cpp_source.html">Decode.cpp</a> / <a class="el" href="Decode_8hpp_source.html">Decode.hpp</a>.</p>
<p>Without the delay of 1 cycle on the <code>in_fetch_queue_write</code>, we will come across a cycle in simulation:</p>
<div class="fragment"><div class="line">Step.Time</div>
<div class="line">   1.0    Fetch receive credits</div>
<div class="line">   2.0    Fetch sends <span class="keyword">new</span> instructions on the out port</div>
<div class="line">   3.0    Decode would receive <span class="keyword">new</span> instructions and process</div>
<div class="line">   4.0    Decode send credits back to Fetch</div>
<div class="line">   5.0    Goto 1?? Oops! Infinite loop!</div>
</div><!-- fragment --><p>Adding the cycle delay:</p>
<div class="fragment"><div class="line">Step.Time</div>
<div class="line">   1.0    Fetch receive credits</div>
<div class="line">   2.0    Fetch sends <span class="keyword">new</span> instructions on the out port</div>
<div class="line">        ... delay</div>
<div class="line">   1.1    Decode would receive <span class="keyword">new</span> instructions and process</div>
<div class="line">   2.1    Decode send credits back to Fetch</div>
<div class="line">   3.1    Fetch receive credits</div>
<div class="line">   4.1    Fetch sends <span class="keyword">new</span> instructions on the out port</div>
<div class="line">        ... delay, etc, etc</div>
</div><!-- fragment --><p>The entire core example follows this paradigm.</p>
<hr  />
 <h1><a class="anchor" id="Building"></a>
Building</h1>
<p>To build the CoreExample, simply type 'make' in the example/CoreModel directory.</p>
<p>Refer to builtin help for up-to-date help and commands, but try running the model with the '-h' option.</p>
<div class="fragment"><div class="line">./bld-Linux_x86_64-gcc4.7/sparta_core_example -h</div>
<div class="line">./bld-Linux_x86_64-gcc4.7/sparta_core_example --verbose-help</div>
</div><!-- fragment --><hr  />
 <h1><a class="anchor" id="Invocations"></a>
Invocations</h1>
<p>Run for 1 million cycles, incrementing a ctr every 1000 cycles. Consume the config file test.yaml and produce a final yaml file called final.yaml. Also, dump the tree:</p>
<div class="fragment"><div class="line">./bld-Linux_x86_64-gcc4.7/sparta_core_example -r 1M \</div>
<div class="line">                     --show-tree -p top.core0.params.ctr_incr_period 1000 \</div>
<div class="line">                     -c <a class="code" href="namespacesparta_1_1utils_1_1has__ostream__operator__impl.html#a42ac3ba777d107c7a9458d5c5054cfe7">test</a>.yaml --write-<span class="keyword">final</span>-config <span class="keyword">final</span>.yaml</div>
</div><!-- fragment --><p>Dump out the parameters:</p>
<div class="fragment"><div class="line">./bld-Linux_x86_64-gcc4.7/sparta_core_example --<a class="code" href="namespacesparta_1_1utils_1_1has__ostream__operator__impl.html#a9204fde3184baa12ed852d5eb0b7bbae">no</a>-run \</div>
<div class="line">                      --write-<span class="keyword">final</span>-config-verbose params.yaml</div>
</div><!-- fragment --><p>Dump out a report in html:</p>
<div class="fragment"><div class="line">./bld-Linux_x86_64-gcc4.7/sparta_core_example -r 1000000 --report-all output.html html</div>
</div><!-- fragment --><p>Example parameter reference </p><div class="fragment"><div class="line">-r1000000 (or -r 1M)        Runs <span class="keywordflow">for</span> 1000000 <span class="stringliteral">&#39;cycles&#39;</span></div>
<div class="line">--show-tree                 shows the Sparta device tree at every step</div>
<div class="line">-p ...                      Sets the value of the parameter identified to 1000</div>
<div class="line">-c <a class="code" href="namespacesparta_1_1utils_1_1has__ostream__operator__impl.html#a42ac3ba777d107c7a9458d5c5054cfe7">test</a>.yaml                Loads <a class="code" href="namespacesparta_1_1utils_1_1has__ostream__operator__impl.html#a42ac3ba777d107c7a9458d5c5054cfe7">test</a>.yaml at the global space and applies its parameters</div>
<div class="line">--write-<span class="keyword">final</span>-config ...    Writes to the selected file after tree finalization</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="anamespacesparta_1_1utils_1_1has__ostream__operator__impl_html_a9204fde3184baa12ed852d5eb0b7bbae"><div class="ttname"><a href="namespacesparta_1_1utils_1_1has__ostream__operator__impl.html#a9204fde3184baa12ed852d5eb0b7bbae">sparta::utils::has_ostream_operator_impl::no</a></div><div class="ttdeci">char no</div><div class="ttdoc">Typedef a char array of size one.</div><div class="ttdef"><b>Definition:</b> <a href="DetectMemberUtils_8hpp_source.html#l00030">DetectMemberUtils.hpp:30</a></div></div>
<div class="ttc" id="anamespacesparta_1_1utils_1_1has__ostream__operator__impl_html_a42ac3ba777d107c7a9458d5c5054cfe7"><div class="ttname"><a href="namespacesparta_1_1utils_1_1has__ostream__operator__impl.html#a42ac3ba777d107c7a9458d5c5054cfe7">sparta::utils::has_ostream_operator_impl::test</a></div><div class="ttdeci">yes &amp; test(std::ostream &amp;)</div><div class="ttdoc">If the class does have an &lt;&lt; operator overloaded,.</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Jun 8 2020 17:53:45 for The Sparta Modeling Framework by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
